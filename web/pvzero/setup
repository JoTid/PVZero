<!DOCTYPE html>
<html lang="en">

  <head>
    <meta name="viewport" charset="UTF-8" content="width=device-width, initial-scale=1, user-scalable=yes; text/html; charset=utf-8">
    <title>PVZ Setup</title>
    <link rel="stylesheet" href="/css/base.css">
  </head>
  <body style="padding-top:58px;">
    <div id="header"></div>
    <div class="base-panel">
        <form action="/pvzero/config/save" method="post">
          <div class="noorder">
            <div>
                <label id="lbl_check_interval" for="check_interval">Prüfintervall</label>
                <input type="range" min="1" max="60" value="1" class="slider" id="check_interval" name="check_interval" oninput="this.nextElementSibling.value = this.value">
                <output id="check_interval_output">1</output>
                <label id="info_check_interval">Sekunden zwischen zwei Prüfungen. Standard: 10 Sekunden.</label>
            </div>
            <!-- <div>
                <label id="lbl_taster_func" for="taster_func">Taster function</label>
                <select id="taster_func" name="taster_func" size="1">
                  <option value="0" selected>keine</option>
                  <option value="1">jetzt prüfen</option>
                </select>
                <label id="info_taster_func">Funktion des blauen Tasters. Standard: jetzt prüfen</label>
            </div> -->
            <div>
                <label id="lbl_shelly3emAddr" for="shelly3emAddr">Shelly Em3 Address</label>
                <input id="shelly3emAddr" type="text" name="shelly3emAddr" placeholder="192.168.1.131">
                <label id="info_shelly3emAddr">/status wird angehängt.</label>
            </div>
            <div>
              <input id="enable_second_psu" type="checkbox" name="enable_second_psu" value="true" checked><label id="lbl_enable_second_psu">Enable second PSU</label></input>
              <label id="info_enable_second_psu">Enables second PSU on serial port. Logging will be disabled.</label>
            </div>
            <div>
              <input id="enable_lcd" type="checkbox" name="enable_lcd" value="true" checked><label id="lbl_enable_lcd">Enable LCD</label></input>
            </div>
            <div class="line_named">Leistungssteuerung</div>
            <div>
              <label id="lbl_voltage" for="max_voltage">Maximale Spannung</label>
              <input id="max_voltage" type="number" step="0.01" name="max_voltage" placeholder="36">
              <label id="info_voltage">Maximale Ausgangsspannung, die über den Step-Up Konverter geregelt werden soll.</label>
            </div>
            <div>
              <label id="lbl_max_amperage" for="max_amperage">Maximale Stromstärke</label>
              <input id="max_amperage" type="number" step="0.01" name="max_amperage" placeholder="7">
              <label id="info_max_amperage">Maximale Stromstärke, die über den Step-Up Konverter geregelt werden soll.</label>
            </div>

        </div>
          <input id="npt_apply" type="submit" name="apply" value="Apply">
        </form>
        <br>
    </div>

    <script>var jsons = [ ["/pvzero/config.json", "fillPVZeroConfig"] ];</script>
    <script src="/js/postload.js"></script>
    <script type="text/javascript">
      function fillPVZeroConfig(data, url) {
        ["check_interval", "shelly3emAddr", "max_voltage", "max_amperage"
        ].forEach(function(id,idy,arr) {
          document.getElementById(id).value = data["pvzero"][id];
        });
        document.getElementById("check_interval_output").value = data["pvzero"]["check_interval"];
        document.getElementById("enable_second_psu").checked = data["pvzero"]["enable_second_psu"];
        document.getElementById("enable_lcd").checked = data["pvzero"]["enable_lcd"];
        // setTimeout(getJSON.bind(null, "/bbs/config.json", "fillBbsConfig"), 3000);
      }
    </script>
  </body>
</html>
